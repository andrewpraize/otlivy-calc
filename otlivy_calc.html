<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Калькулятор сметы</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { font-family: sans-serif; background: #f8f8fa; margin: 0; padding: 40px;}
    form { max-width: 500px; margin: auto; background: #fff; padding: 24px 28px 20px 28px; border-radius: 14px; box-shadow: 0 2px 16px #0001;}
    label { display: block; margin: 18px 0 6px;}
    input[type="text"], input[type="number"], select { width: 100%; padding: 6px 8px; margin-top: 3px; border-radius: 6px; border: 1px solid #bbb;}
    #sides-inputs label { margin: 6px 0 0;}
    .results { margin-top: 24px; background: #f3f7fb; padding: 16px; border-radius: 10px; }
    .results span { font-weight: bold; }
    .title {font-size: 1.4em; margin-bottom: 18px; text-align:center;}
    .inline { display: inline-block; margin-right: 14px;}
  </style>
</head>
<body>
  <form id="calc-form" autocomplete="off">
    <div class="title">Калькулятор расчёта сметы</div>
    <label>Наименование изделия
      <input type="text" id="name" placeholder="Например: Откос, Отлив, Планка...">
    </label>
    <label>Материал
      <select id="material">
        <option value="polymer">Полимер</option>
        <option value="zinc">Цинк</option>
      </select>
    </label>
    <label>Толщина (мм)
      <select id="thickness"></select>
    </label>
    <label>Длина изделия (м)
      <input type="number" id="length" max="3" min="0.1" step="0.01" value="1">
    </label>
    <label id="paint-label" style="display:none;">
      <input type="checkbox" id="paint"> Покраска
    </label>
    <label>Количество изделий
      <input type="number" id="qty" min="1" max="500" value="1">
    </label>
    <label>Количество сторон
      <input type="number" id="sides-count" min="1" max="10" value="4">
    </label>
    <div id="sides-inputs"></div>

    <div class="results">
      <div>Общая площадь (м²): <span id="total-area">0.00</span></div>
      <div>Стоимость материала: <span id="mat-price">0</span> ₽</div>
      <div>Стоимость с покраской: <span id="mat-price-painted">0</span> ₽</div>
      <div>Стоимость гиба: <span id="bend-price">0</span> ₽</div>
    </div>
  </form>

  <script>
    // Вставь свои цены!
    const THICKNESS_OPTIONS = {
      polymer: [0.5, 0.7, 0.45],
      zinc: [0.5, 0.7, 0.55]
    };
    const MATERIAL_PRICES = {
      polymer: {0.5: 600, 0.7: 800, 0.45: 540},  // Примерные цены за 1м²
      zinc:    {0.5: 400, 0.7: 500, 0.55: 460}
    };
    const PAINT_PRICE = {zinc: 120};   // Цена покраски за 1м²
    const BEND_PRICE = 50;             // Стоимость гиба за изделие

    // ---- Логика ----
    function updateThicknessOptions() {
      const material = document.getElementById('material').value;
      const thicknessSelect = document.getElementById('thickness');
      thicknessSelect.innerHTML = '';
      THICKNESS_OPTIONS[material].forEach(val => {
        let opt = document.createElement('option');
        opt.value = val;
        opt.textContent = val;
        thicknessSelect.appendChild(opt);
      });
      // Покраска чекбокс (только для цинка)
      document.getElementById('paint-label').style.display = (material === 'zinc') ? '' : 'none';
      recalc(); // Обновить расчёт при смене материала/толщины
    }

    function updateSidesInputs() {
      let n = parseInt(document.getElementById('sides-count').value, 10) || 0;
      let div = document.getElementById('sides-inputs');
      div.innerHTML = '';
      for (let i=1; i<=n; i++) {
        div.innerHTML += `<label>Сторона ${i} (см): <input type="number" class="side-len" min="0" value="10"></label>`;
      }
      recalc();
    }

    function recalc() {
      // Считаем сумму сторон (метры)
      let sides = [...document.querySelectorAll('.side-len')].map(input => +input.value || 0);
      let sidesSumMeters = sides.reduce((a,b)=>a+b,0) / 100;
      let length = +document.getElementById('length').value || 0;
      let qty = +document.getElementById('qty').value || 1;
      // Формула площади
      let area = sidesSumMeters * length * qty;
      document.getElementById('total-area').textContent = area.toFixed(2);

      let material = document.getElementById('material').value;
      let thickness = document.getElementById('thickness').value;
      let matPricePerM2 = MATERIAL_PRICES[material][thickness] || 0;
      let matCost = area * matPricePerM2;
      document.getElementById('mat-price').textContent = matCost.toFixed(0);

      // Стоимость с покраской
      let paint = (material==='zinc' && document.getElementById('paint').checked) ? PAINT_PRICE[material] : 0;
      let matCostPainted = matCost + area * paint;
      document.getElementById('mat-price-painted').textContent = matCostPainted.toFixed(0);

      // Гиб
      let bendCost = Math.max(BEND_PRICE * qty, 50); // Не ниже 50р
      document.getElementById('bend-price').textContent = bendCost.toFixed(0);
    }

    // События
    document.getElementById('material').addEventListener('change', updateThicknessOptions);
    document.getElementById('sides-count').addEventListener('input', updateSidesInputs);
    document.getElementById('calc-form').addEventListener('input', recalc);

    // Старт
    updateThicknessOptions();
    updateSidesInputs();
    recalc();
  </script>
</body>
</html>
